<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>Necdet Oyunu</title>

<style>
html,body{
    margin:0;
    padding:0;
    background:black;
    overflow:hidden;
    touch-action:none;
    font-family:Arial, sans-serif;
}
canvas{display:block;background:#222}

/* EKRANLAR */
.screen{
    position:fixed;
    inset:0;
    display:none;
    justify-content:center;
    align-items:center;
    flex-direction:column;
    background:rgba(0,0,0,0.9);
    z-index:20;
}
#menu{display:flex}

.menuBtn{
    padding:15px 30px;
    margin:10px;
    font-size:22px;
    border-radius:12px;
    border:none;
    background:#3fa9f5;
    color:white;
}

/* MOBÄ°L TUÅLAR */
.controls{
    position:fixed;
    bottom:20px;
    left:20px;
    display:grid;
    grid-template-columns:60px 60px 60px;
    grid-template-rows:60px 60px;
    gap:10px;
    z-index:10;
}
.btn{
    background:rgba(255,255,255,0.3);
    border-radius:12px;
    color:white;
    font-size:26px;
    text-align:center;
    line-height:60px;
    user-select:none;
}

/* Ã‡IKIÅ */
#exitKayak{
    position:fixed;
    top:15px;
    right:15px;
    padding:10px 18px;
    font-size:18px;
    border:none;
    border-radius:10px;
    background:#ff4444;
    color:white;
    display:none;
    z-index:30;
}
</style>
</head>
<body>

<button id="exitKayak">Ã‡Ä±kÄ±ÅŸ</button>

<!-- ANA MENÃœ -->
<div id="menu" class="screen">
    <h1 style="color:white">NECDET OYUNU</h1>
    <button class="menuBtn" onclick="startGame()">â–¶ï¸ Oyna</button>
    <button class="menuBtn" onclick="openSettings()">âš™ï¸ Ayarlar</button>
</div>

<div id="settings" class="screen">
    <p style="color:red;font-size:20px;text-align:center">
        DAHA BÄ°ÅEY GELMEDÄ° BELKÄ° GELÄ°R LAN SABUN<br>â€” Musti Baba
    </p>
    <button class="menuBtn" onclick="backToMenu()">â¬…ï¸ Ã‡Ä±kÄ±ÅŸ</button>
</div>

<div id="death" class="screen">
    <h1 style="color:red">Ã–LDÃœN LAN SOÄAN!</h1>
    <button class="menuBtn" onclick="restartGame()">ğŸ”„ Yeniden BaÅŸlat</button>
    <button class="menuBtn" onclick="backToMenu()">ğŸ  Ana MenÃ¼</button>
</div>

<div id="win" class="screen">
    <h1 style="color:lime">KAZANDIN BE DOMATES!</h1>
    <button class="menuBtn" onclick="restartGame()">ğŸ”„ Tekrar Oyna</button>
    <button class="menuBtn" onclick="backToMenu()">ğŸ  Ana MenÃ¼</button>
</div>

<canvas id="game"></canvas>

<div class="controls">
    <div></div><div class="btn" id="up">â¬†ï¸</div><div></div>
    <div class="btn" id="left">â¬…ï¸</div>
    <div class="btn" id="down">â¬‡ï¸</div>
    <div class="btn" id="right">â¡ï¸</div>
</div>

<script>
const canvas=document.getElementById("game");
const ctx=canvas.getContext("2d");
const exitKayak=document.getElementById("exitKayak");

function resize(){
    canvas.width=innerWidth;
    canvas.height=innerHeight;
}
resize(); addEventListener("resize",resize);

let playing=false;
let mode="normal";
let move={up:false,down:false,left:false,right:false};
let hearts=[];
let necdet,asya,golem,mega,winZone,kayakZone,cinar;
let message="",messageTimer=0;

function resetGame(){
    mode="normal";
    necdet={x:50,y:200,size:35,speed:4,name:"Necdet"};
    asya={x:200,y:200,size:35,name:"Asya"};
    golem={x:220,y:450,size:70,speed:1.1,name:"Ä°ksir Golemi",color:"#8000ff"};
    mega={x:60,y:520,size:60,speed:1.3,name:"Mega ÅÃ¶valye",color:"yellow"};
    winZone={x:canvas.width-150,y:0,w:150,h:canvas.height,name:"Nedim MÃ¼zesi"};
    kayakZone={x:canvas.width/2-80,y:canvas.height/2-50,w:160,h:100};
    cinar={x:canvas.width/2,y:canvas.height/2,size:50};
    hearts=[];
    message="";
    exitKayak.style.display="none";
}

function hideAll(){
    ["menu","settings","death","win"].forEach(id=>{
        document.getElementById(id).style.display="none";
    });
}

function startGame(){hideAll();resetGame();playing=true;}
function restartGame(){hideAll();resetGame();playing=true;}
function openSettings(){hideAll();settings.style.display="flex";}
function backToMenu(){hideAll();playing=false;menu.style.display="flex";}

function drawName(t,x,y){
    ctx.fillStyle="white";
    ctx.font="16px Arial";
    ctx.textAlign="center";
    ctx.fillText(t,x,y);
}

function spawnHeart(x,y){hearts.push({x,y,life:60});}

function rect(a,b){
    return a.x<a.x+b.w &&
           a.x+a.size>b.x &&
           a.y<a.y+b.h &&
           a.y+a.size>b.y;
}

function update(){
    if(!playing) return;

    if(move.up) necdet.y-=necdet.speed;
    if(move.down) necdet.y+=necdet.speed;
    if(move.left) necdet.x-=necdet.speed;
    if(move.right) necdet.x+=necdet.speed;

    necdet.x=Math.max(0,Math.min(canvas.width-necdet.size,necdet.x));
    necdet.y=Math.max(0,Math.min(canvas.height-necdet.size,necdet.y));

    if(mode==="normal"){
        if(Math.hypot(necdet.x-asya.x,necdet.y-asya.y)<40 && Math.random()<0.2)
            spawnHeart(asya.x,asya.y);

        [golem,mega].forEach(e=>{
            let dx=necdet.x-e.x, dy=necdet.y-e.y;
            let d=Math.hypot(dx,dy);
            e.x+=(dx/d)*e.speed;
            e.y+=(dy/d)*e.speed;
            if(d<45){playing=false;death.style.display="flex";}
        });

        if(necdet.x+necdet.size>winZone.x){
            playing=false;
            win.style.display="flex";
        }

        if(rect(necdet,kayakZone)){
            mode="kayak";
            exitKayak.style.display="block";
            necdet.x=50; necdet.y=50;
        }
    }

    if(mode==="kayak"){
        if(Math.hypot(necdet.x-cinar.x,necdet.y-cinar.y)<40){
            message="Mustafa Tam Bir Joni Sins";
            messageTimer=180;
        }
        if(messageTimer>0) messageTimer--;
    }

    hearts.forEach(h=>{h.y--;h.life--;});
    hearts=hearts.filter(h=>h.life>0);
}

function draw(){
    if(!playing) return;

    if(mode==="kayak"){
        ctx.fillStyle="white";
        ctx.fillRect(0,0,canvas.width,canvas.height);
    }else{
        ctx.clearRect(0,0,canvas.width,canvas.height);
    }

    ctx.fillStyle="#3fa9f5";
    ctx.fillRect(necdet.x,necdet.y,necdet.size,necdet.size);
    drawName(necdet.name,necdet.x+necdet.size/2,necdet.y-10);

    if(mode==="normal"){
        ctx.fillStyle="#ff69b4";
        ctx.fillRect(asya.x,asya.y,asya.size,asya.size);
        drawName(asya.name,asya.x+asya.size/2,asya.y-10);

        ctx.fillStyle="#0a3";
        ctx.fillRect(winZone.x,winZone.y,winZone.w,winZone.h);
        drawName(winZone.name,winZone.x+winZone.w/2,30);

        ctx.fillStyle="cyan";
        ctx.fillRect(kayakZone.x,kayakZone.y,kayakZone.w,kayakZone.h);
        drawName("Kayak Merkezi",kayakZone.x+kayakZone.w/2,kayakZone.y-10);

        [golem,mega].forEach(e=>{
            ctx.fillStyle=e.color;
            ctx.fillRect(e.x,e.y,e.size,e.size);
            drawName(e.name,e.x+e.size/2,e.y-10);
        });

        hearts.forEach(h=>{
            ctx.font="20px Arial";
            ctx.fillText("ğŸ’–",h.x,h.y);
        });
    }

    if(mode==="kayak"){
        ctx.fillStyle="red";
        ctx.fillRect(cinar.x,cinar.y,cinar.size,cinar.size);
        drawName("Ã‡Ä±nar",cinar.x+cinar.size/2,cinar.y-10);

        if(messageTimer>0){
            ctx.fillStyle="blue";
            ctx.font="28px Arial";
            ctx.fillText(message,canvas.width/2,60);
        }
    }
}

exitKayak.onclick=()=>{
    mode="normal";
    exitKayak.style.display="none";
    necdet.x=50; necdet.y=200;
};

function loop(){update();draw();requestAnimationFrame(loop);}
loop();

/* KONTROLLER */
function bind(id,dir){
    const b=document.getElementById(id);
    b.addEventListener("touchstart",e=>{e.preventDefault();move[dir]=true});
    b.addEventListener("touchend",()=>move[dir]=false);
    b.addEventListener("mousedown",()=>move[dir]=true);
    b.addEventListener("mouseup",()=>move[dir]=false);
}
["up","down","left","right"].forEach(d=>bind(d,d));

addEventListener("keydown",e=>{
    if(e.key=="ArrowUp"||e.key=="w")move.up=true;
    if(e.key=="ArrowDown"||e.key=="s")move.down=true;
    if(e.key=="ArrowLeft"||e.key=="a")move.left=true;
    if(e.key=="ArrowRight"||e.key=="d")move.right=true;
});
addEventListener("keyup",e=>{
    if(e.key=="ArrowUp"||e.key=="w")move.up=false;
    if(e.key=="ArrowDown"||e.key=="s")move.down=false;
    if(e.key=="ArrowLeft"||e.key=="a")move.left=false;
    if(e.key=="ArrowRight"||e.key=="d")move.right=false;
});
</script>

</body>
</html>
